<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>4. SCRIPTING - Serveis en Xarxa CFGM</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "4. SCRIPTING";
        var mkdocs_page_input_path = "u4-Scripting.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Serveis en Xarxa CFGM
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">SERVEIS EN XARXA CFGM</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../u1-conceptes-xarxes/">1. CONCEPTES SOBRE XARXES</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../exercicis-ipv4/">1.1. Exercicis ipv4</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../u2-servei-ftp/">2. SERVEI FTP</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../preguntes-test/">2.1 Preguntes exemple</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../u2-ftp-vsftpd/">2.2 Instal.lació vsFTPd</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../u2-test-preguntes/">2.3 Preguntes test</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../u3-servei-http/">3. SERVEI HTTP</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">4. SCRIPTING</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#41-que-es-un-script">4.1 Què és un script?</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#42-primer-script-echo-hello-world">4.2 Primer script. echo "Hello world".</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#43-variables">4.3 Variables</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#exercicis">Exercicis:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#44-condicionals-if">4.4 Condicionals if</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#exemples">Exemples</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exercicis_1">Exercicis:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#45-funcions-de-programa">4.5 Funcions de programa</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#46-iteracions">4.6 Iteracions</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../errors-comuns/">Errors Comuns Apache</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../provaVue/">(provaVue)</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Serveis en Xarxa CFGM</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">4. SCRIPTING</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="unitat-4-scripts">UNITAT 4. SCRIPTS</h1>
<p>| Els scripts Són documents que contenen un guió d'execució d'instruccions. En aquest tema feim una aproximació als scripts del shell. Durant el tema farem pràctiques que volen ser útils per un administrador de sistemes o developer. |</p>
<p>Els scripts solen contenir tasques repetitives com per exemple realitzar còpies de seguretat, creació d'usuaris, obertura de sessions, ... </p>
<p>Com la majoria de llenguatges de programació els scripts també tenen variables, funcions, estructures de control, execucions d'entrada i sortida, estructures de dades, ... </p>
<p>Per entendre el seu funcionament ho farem amb una sèrie d'exercicis bàsics, per tant ens disposam a començar. </p>
<h2 id="41-que-es-un-script">4.1 Què és un script?</h2>
<p>Un <strong>script</strong>: </p>
<ul>
<li>És un document de texte i té l'extensió <code>.sh</code></li>
<li>Si volem que s'excuti ha de tenir els permisos d'execució.</li>
<li>Per executar un script es fa amb l'instrucció <code>./nom-script</code></li>
</ul>
<p>Per fer els exercicis cream una carpeta "scripts" al directori home del nostre usuari.</p>
<h2 id="42-primer-script-echo-hello-world">4.2 Primer script. echo "Hello world".</h2>
<p>Feim un document "primerscript.sh" de texte i el seu contingut ha de ser </p>
<pre><code>
#!/bin/sh 
# This is a comment!
echo Hello World        
# This is a comment, too!

</code></pre>
<p>Per executar l'script hem de donar permisos d'execució a l'arxiu, l'instrucció </p>
<table>
<thead>
<tr>
<th>sudo chmod 755 primerscript.sh</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<pre><code>
$ echo '#!/bin/sh' &gt; my-script.sh
$ echo 'echo Hello World' &gt;&gt; my-script.sh
$ chmod 755 my-script.sh
$ ./my-script.sh
Hello World
$

</code></pre>
<h2 id="43-variables">4.3 Variables</h2>
<p>Una variable és un contenidor de valors amb un nom. Aquest contenidor varia durant l'execució del programa. </p>
<p>Observa el dibuix de programa durant l'execució dins el computador.</p>
<p>Observam a la pàgina <a href="https://pythontutor.com/visualize.html#mode=edit">pythonTutor</a> la execució i gestió de variables dins memòria.</p>
<h3 id="exercicis">Exercicis:</h3>
<p>A cada un dels scritps has de posar el teu nom i la data com a comentari. Per fer els exercicis pots consultar el <a href="https://www.shellscript.sh/variables1.html">tutorial de consulta sobre variables</a>.</p>
<ol>
<li>Fer un script que escrigui "Hello World".</li>
<li>Fer un script "sumados.sh" que sumi dos nombres passats per paràmetre.</li>
<li>Un script com l'anterior que ens retorni la suma, la resta i la multiplicació de dos nombres passats per paràmetre.</li>
<li>Un script que faci les operacions anteriors (suma,resta, multiplicació) però que ens 
demani els operands per terminal. </li>
<li>Fes un script que demani el nom d'un usuari i que mostri per pantalla la seva unitat home.</li>
<li>Fes un script que demani el nom d'un usuari i que mostri per pantalla la mida dels arxius del seu home.</li>
<li>Posa tots els exercici anteriors com a exercici1.sh, exercici2.sh, ...</li>
<li>Comprimeix els exercicis i posals a la teva carpeta del servidor ftp gimnesia.</li>
</ol>
<h2 id="44-condicionals-if">4.4 Condicionals if</h2>
<pre><code>
if (⟨Condició⟩) {
    ⟨Instruccions_SÍ⟩
} else {
    ⟨Instruccions_NO⟩
}

</code></pre>
<p>El funcionament és senzill: Si es compleix la ⟨Condició⟩, s'executa el bloc d'⟨Instruccions_SÍ⟩; altrament, s'executa el bloc d'⟨Instruccions_NO⟩.</p>
<p>Aquesta instrucció és útil alhora de controlar límits, comprovar passwords, crear camins de programa, etc.</p>
<h3 id="exemples">Exemples</h3>
<ul>
<li>Volem saber si un número és positiu, negatiu o zero.</li>
</ul>
<pre><code>read -p &quot;Introdueix un número: &quot; numero

if (( $numero &gt; 0 )); then
    echo &quot;El número $numero és positiu.&quot;
elif (( $numero &lt; 0 )); then
    echo &quot;El número $numero és negatiu.&quot;
else
    echo &quot;El número és zero.&quot;
fi

</code></pre>
<ul>
<li>Volem saber si un usuari està connectat.</li>
</ul>
<pre><code>
#!/bin/bash

read -p &quot;Introdueix el nom de l'usuari: &quot; usuari

if who | grep -q &quot;^$usuari &quot;; then
    echo &quot;L'usuari $usuari està connectat.&quot;
else
    echo &quot;L'usuari $usuari no està connectat.&quot;
fi

</code></pre>
<ul>
<li>Volem saber si un número és parell o senar. </li>
</ul>
<pre><code>
#!/bin/bash

read -p &quot;Introdueix un nombre: &quot; nombre

if (( $nombre % 2 == 0 )); then
    echo &quot;El nombre $nombre és parell.&quot;
else
    echo &quot;El nombre $nombre és senar.&quot;
fi

</code></pre>
<ul>
<li>Saber si un fitxer existeix.</li>
</ul>
<pre><code>
#!/bin/bash

read -p &quot;Introdueix la ruta del fitxer: &quot; fitxer

if [[ -e $fitxer ]]; then
    echo &quot;El fitxer $fitxer existeix.&quot;
else
    echo &quot;El fitxer $fitxer no existeix.&quot;
fi

</code></pre>
<h3 id="exercicis_1">Exercicis:</h3>
<ol>
<li>Fes un script que compari dos nombres passats per argument i digui quin és el més alt i quin és el més baix. Si són iguals ha de dir que són iguals.</li>
<li>Com l'script anterior però amb tres números.</li>
<li>Fes un script que agafi dos arguments per consola i respongui si són multiples.</li>
<li>Fes un script que comprovi un password.</li>
</ol>
<p><a href="https://www.shellscript.sh/">tutorial</a></p>
<h2 id="45-funcions-de-programa">4.5 Funcions de programa</h2>
<p>Les funcions són parts de codi que realitzen una tasca concreta. L'ús de funcions ajuda al programador a 
controlar el codi del programa d'una manera més eficient.</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>CADA FUNCIÓ REALITZA UN SOL TIPUS DE TASCA.</td>
</tr>
<tr>
<td>HAN DE CALCULAR SOBRE ELS SEUS PARÀMETRES.</td>
</tr>
<tr>
<td>NO HAN D'IMPRIMIR PER PANTALLA NI DEMANAR RES S'AIXÒ S'ENCARREGA EL MAIN.</td>
</tr>
<tr>
<td>EL MAIN ÉS EL PROGRAMA PRINCIPAL, CRIDARÀ LES FUNCIONS</td>
</tr>
</tbody>
</table>
<p>Una funció té varies parts:</p>
<pre><code>- *Nom de la funció**. Única dins la seva part de programa, identifica la tasca de la funció.
- **Paràmetres d'entrada**. Variables que es poden donar a la funció.
- **Instruccions** de la funció.
- **Paràmetres de Sortida**. El retorn d'una funció és una variable o conjunt de variables.
</code></pre>
<p>EXEMPLE:</p>
<pre><code>
#!/bin/bash

#Funció per trobar el número major entre dos
major() {
    if (( $1 &gt; $2 )); then
        echo &quot;El major entre $1 i $2 és: $1&quot;
    elif (( $1 &lt; $2 )); then
        echo &quot;El major entre $1 i $2 és: $2&quot;
    else
        echo &quot;Els números $1 i $2 són iguals.&quot;
    fi
}

#Funció per trobar el número menor entre dos
menor() {
    if (( $1 &lt; $2 )); then
        echo &quot;El menor entre $1 i $2 és: $1&quot;
    elif (( $1 &gt; $2 )); then
        echo &quot;El menor entre $1 i $2 és: $2&quot;
    else
        echo &quot;Els números $1 i $2 són iguals.&quot;
    fi
}

#Funció per comprovar si el primer número és múltiple del segon
multiple() {
    if (( $2 == 0 )); then
        echo &quot;No es pot dividir per zero, no hi ha múltiple.&quot;
        return
    fi

    if (( $1 % $2 == 0 )); then
        echo &quot;$1 és múltiple de $2.&quot;
    else
        echo &quot;$1 no és múltiple de $2.&quot;
    fi
}

#Entrada de dades
read -p &quot;Introdueix el primer número: &quot; num1
read -p &quot;Introdueix el segon número: &quot; num2

#Crides a les funcions
major &quot;$num1&quot; &quot;$num2&quot;
menor &quot;$num1&quot; &quot;$num2&quot;
multiple &quot;$num1&quot; &quot;$num2&quot;

</code></pre>
<h2 id="46-iteracions">4.6 Iteracions</h2>
<p>Les iteracions permeten executar repetidament una sèrie d'instruccions. </p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="600" height="400">
    <!-- Títol -->
    <text x="200" y="30" font-size="20" font-family="Arial" fill="black">Execució d'un IF i un FOR</text></p>
<pre><code>&lt;!-- Diagrama IF --&gt;
&lt;!-- Títol del bloc --&gt;
&lt;text x="50" y="60" font-size="16" font-family="Arial" fill="black"&gt;Bloc IF&lt;/text&gt;

&lt;!-- Rectangles i fletxes per l'IF --&gt;
&lt;rect x="50" y="80" width="120" height="40" fill="lightblue" stroke="black"/&gt;
&lt;text x="80" y="105" font-size="14" font-family="Arial"&gt;Condició&lt;/text&gt;
&lt;line x1="110" y1="120" x2="110" y2="140" stroke="black" marker-end="url(#arrow)" /&gt;
&lt;rect x="50" y="140" width="120" height="40" fill="lightgreen" stroke="black"/&gt;
&lt;text x="65" y="165" font-size="14" font-family="Arial"&gt;Codi SI&lt;/text&gt;
&lt;line x1="110" y1="180" x2="110" y2="200" stroke="black" marker-end="url(#arrow)" /&gt;
&lt;rect x="50" y="200" width="120" height="40" fill="lightcoral" stroke="black"/&gt;
&lt;text x="65" y="225" font-size="14" font-family="Arial"&gt;Codi NO&lt;/text&gt;

&lt;!-- Diagrama FOR --&gt;
&lt;!-- Títol del bloc --&gt;
&lt;text x="300" y="60" font-size="16" font-family="Arial" fill="black"&gt;Bloc FOR&lt;/text&gt;

&lt;!-- Rectangles i fletxes per al FOR --&gt;
&lt;rect x="300" y="80" width="150" height="40" fill="lightblue" stroke="black"/&gt;
&lt;text x="330" y="105" font-size="14" font-family="Arial"&gt;Inici del FOR&lt;/text&gt;
&lt;line x1="375" y1="120" x2="375" y2="140" stroke="black" marker-end="url(#arrow)" /&gt;
&lt;rect x="300" y="140" width="150" height="40" fill="lightgreen" stroke="black"/&gt;
&lt;text x="320" y="165" font-size="14" font-family="Arial"&gt;Iteració&lt;/text&gt;
&lt;line x1="375" y1="180" x2="375" y2="220" stroke="black" marker-end="url(#arrow)" /&gt;
&lt;line x1="375" y1="220" x2="375" y2="250" stroke="black" marker-end="url(#arrow)" /&gt;
&lt;rect x="300" y="250" width="150" height="40" fill="lightcoral" stroke="black"/&gt;
&lt;text x="320" y="275" font-size="14" font-family="Arial"&gt;Final&lt;/text&gt;

&lt;!-- Fletxa d'iteració --&gt;
&lt;line x1="375" y1="250" x2="425" y2="250" stroke="black" marker-end="url(#arrow)" /&gt;
&lt;line x1="425" y1="250" x2="425" y2="140" stroke="black" marker-end="url(#arrow)" /&gt;
&lt;line x1="425" y1="140" x2="375" y2="140" stroke="black" marker-end="url(#arrow)" /&gt;

&lt;!-- Definició del marcador de fletxa --&gt;
&lt;defs&gt;
    &lt;marker id="arrow" markerWidth="10" markerHeight="10" refX="6" refY="3" orient="auto"&gt;
        &lt;path d="M0,0 L0,6 L9,3 z" fill="black" /&gt;
    &lt;/marker&gt;
&lt;/defs&gt;
</code></pre>
<p></svg></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="400" height="300">
  <!-- Inici --></p>
<p><rect x="150" y="20" width="100" height="40" fill="lightblue" stroke="black" />
  <text x="175" y="45" font-size="16" font-family="Arial">Inici</text></p>
<!-- Fletxa cap a condició -->
<p><line x1="200" y1="60" x2="200" y2="100" stroke="black" stroke-width="2" />
  <polygon points="195,100 205,100 200,110" fill="black" /></p>
<!-- Condició -->
<p><rect x="125" y="110" width="150" height="40" fill="lightgreen" stroke="black" />
  <text x="150" y="135" font-size="16" font-family="Arial">Condició?</text></p>
<!-- Fletxa si condició és certa -->
<p><line x1="125" y1="130" x2="75" y2="130" stroke="black" stroke-width="2" />
  <polygon points="75,125 75,135 65,130" fill="black" /></p>
<p><rect x="25" y="110" width="50" height="40" fill="lightcoral" stroke="black" />
  <text x="30" y="135" font-size="16" font-family="Arial">Sí</text></p>
<!-- Fletxa si condició és falsa -->
<p><line x1="275" y1="130" x2="325" y2="130" stroke="black" stroke-width="2" />
  <polygon points="325,125 325,135 335,130" fill="black" /></p>
<p><rect x="325" y="110" width="50" height="40" fill="lightcoral" stroke="black" />
  <text x="330" y="135" font-size="16" font-family="Arial">No</text>
</svg></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../u3-servei-http/" class="btn btn-neutral float-left" title="3. SERVEI HTTP"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../errors-comuns/" class="btn btn-neutral float-right" title="Errors Comuns Apache">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../u3-servei-http/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../errors-comuns/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
